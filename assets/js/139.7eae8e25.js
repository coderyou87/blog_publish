(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{388:function(t,s,a){"use strict";a.r(s);var r=a(42),n=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("[toc]")]),t._v(" "),a("h1",{attrs:{id:"课程目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#课程目标"}},[t._v("#")]),t._v(" 课程目标")]),t._v(" "),a("ul",[a("li",[t._v("熟悉awk的"),a("strong",[t._v("命令行模式")]),t._v("基本语法结构")]),t._v(" "),a("li",[t._v("==熟悉awk的相关内部变量==")]),t._v(" "),a("li",[t._v("熟悉awk常用的打印==函数print==")]),t._v(" "),a("li",[t._v("能够在awk中匹配正则表达式打印相关的行")])]),t._v(" "),a("h1",{attrs:{id:"一、awk介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、awk介绍"}},[t._v("#")]),t._v(" 一、awk介绍")]),t._v(" "),a("h2",{attrs:{id:"_1-awk概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-awk概述"}},[t._v("#")]),t._v(" 1. awk概述")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("awk是一种==编程语言==，主要用于在linux/unix下对==文本和数据==进行处理，是linux/unix下的一个工具。数据可以来自标准输入、一个或多个文件，或其它命令的输出。")])]),t._v(" "),a("li",[a("p",[t._v("awk的处理文本和数据的方式："),a("strong",[t._v("==逐行扫描==文件")]),t._v("，默认从第一行到最后一行，寻找匹配的==特定模式==的行，并在这些行上进行你想要的操作。")])]),t._v(" "),a("li",[a("p",[t._v("awk分别代表其作者姓氏的第一个字母。因为它的作者是三个人，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。")])]),t._v(" "),a("li",[a("p",[t._v("gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。")])]),t._v(" "),a("li",[a("p",[t._v("下面介绍的awk是以GNU的gawk为例的，在linux系统中已把awk链接到gawk，所以下面全部以awk进行介绍。")])])]),t._v(" "),a("h2",{attrs:{id:"_2-awk能干啥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-awk能干啥"}},[t._v("#")]),t._v(" 2. awk能干啥?")]),t._v(" "),a("ol",[a("li",[t._v("awk==用来处理文件和数据==的，是类unix下的一个工具，也是一种编程语言")]),t._v(" "),a("li",[t._v("可以用来==统计数据==，比如网站的访问量，访问的IP量等等")]),t._v(" "),a("li",[t._v("支持条件判断，支持for和while循环")])]),t._v(" "),a("h1",{attrs:{id:"二、awk使用方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、awk使用方式"}},[t._v("#")]),t._v(" 二、awk使用方式")]),t._v(" "),a("h2",{attrs:{id:"_1-命令行模式使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令行模式使用"}},[t._v("#")]),t._v(" 1. ==命令行模式使用==")]),t._v(" "),a("h3",{attrs:{id:"㈠-语法结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈠-语法结构"}},[t._v("#")]),t._v(" ㈠ 语法结构")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("awk 选项 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'命令部分'")]),t._v(" 文件名\n\n\n特别说明：\n引用shell变量需用双引号引起\n\n")])])]),a("h3",{attrs:{id:"㈡-常用选项介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈡-常用选项介绍"}},[t._v("#")]),t._v(" ㈡ 常用选项介绍")]),t._v(" "),a("ul",[a("li",[t._v("==-F==  定义字段分割符号，默认的分隔符是==空格==")]),t._v(" "),a("li",[t._v("-v  定义变量并赋值")])]),t._v(" "),a("h3",{attrs:{id:"㈢-命名部分说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈢-命名部分说明"}},[t._v("#")]),t._v(" ㈢  命名部分说明")]),t._v(" "),a("ul",[a("li",[t._v("正则表达式，地址定位")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/root/{awk语句}'")]),t._v("\t\t\t\tsed中： "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/root/p'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR==1,NR==5{awk语句}'")]),t._v("\t\t\tsed中： "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1,5p'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^root/,/^ftp/{awk语句}'")]),t._v("  \tsed中："),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^root/,/^ftp/p'")]),t._v("\n")])])]),a("ul",[a("li",[t._v("{awk语句1**==;=="),a("strong",[t._v("awk语句2")]),t._v("==;==**...}")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $0;print $1}'")]),t._v("\t\tsed中："),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR==5{print $0}'")]),t._v("\t\t\t\tsed中："),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5p'")]),t._v("\n注：awk命令语句间用分号间隔\n")])])]),a("ul",[a("li",[t._v("BEGIN...END....")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BEGIN{awk语句};{处理中};END{awk语句}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BEGIN{awk语句};{处理中}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{处理中};END{awk语句}'")]),t._v("\n")])])]),a("h2",{attrs:{id:"_2-脚本模式使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-脚本模式使用"}},[t._v("#")]),t._v(" 2. 脚本模式使用")]),t._v(" "),a("h3",{attrs:{id:"㈠-脚本编写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈠-脚本编写"}},[t._v("#")]),t._v(" ㈠ 脚本编写")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/awk -f \t\t定义魔法字符")]),t._v("\n以下是awk引号里的命令清单，不要用引号保护命令，多个命令用分号间隔\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("FS="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nNR==1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("NR==3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("print "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\t"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("h3",{attrs:{id:"㈡-脚本执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈡-脚本执行"}},[t._v("#")]),t._v(" ㈡ 脚本执行")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("方法1：\nawk 选项 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f awk的脚本文件  要处理的文本文件\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f awk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh filename\n\nsed "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f sed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i filename\n\n方法2：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("awk的脚本文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("或者绝对路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t要处理的文本文件\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("awk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh filename\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh filename\n")])])]),a("h1",{attrs:{id:"三、-awk内部相关变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、-awk内部相关变量"}},[t._v("#")]),t._v(" 三、 awk内部相关变量")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("变量")]),t._v(" "),a("th",[t._v("变量说明")]),t._v(" "),a("th",[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("==$0==")]),t._v(" "),a("td",[t._v("当前处理行的所有记录")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("==$1,$2,$3...$n==")]),t._v(" "),a("td",[t._v("文件中每行以==间隔符号==分割的不同字段")]),t._v(" "),a("td",[t._v("awk -F: '{print $1,$3}'")])]),t._v(" "),a("tr",[a("td",[t._v("==NF==")]),t._v(" "),a("td",[t._v("当前记录的字段数（列数）")]),t._v(" "),a("td",[t._v("awk -F: '{print NF}'")])]),t._v(" "),a("tr",[a("td",[t._v("==$NF==")]),t._v(" "),a("td",[t._v("最后一列")]),t._v(" "),a("td",[t._v("$(NF-1)表示倒数第二列")])]),t._v(" "),a("tr",[a("td",[t._v("==FNR/NR==")]),t._v(" "),a("td",[t._v("行号")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("==FS==")]),t._v(" "),a("td",[t._v("定义间隔符")]),t._v(" "),a("td",[t._v("'BEGIN{FS=\":\"};{print $1,$3}'")])]),t._v(" "),a("tr",[a("td",[t._v("==OFS==")]),t._v(" "),a("td",[t._v("定义输出字段分隔符，==默认空格==")]),t._v(" "),a("td",[t._v("'BEGIN{OFS=\"\\t\"};print $1,$3}'")])]),t._v(" "),a("tr",[a("td",[t._v("RS")]),t._v(" "),a("td",[t._v("输入记录分割符，默认换行")]),t._v(" "),a("td",[t._v("'BEGIN{RS=\"\\t\"};{print $0}'")])]),t._v(" "),a("tr",[a("td",[t._v("ORS")]),t._v(" "),a("td",[t._v("输出记录分割符，默认换行")]),t._v(" "),a("td",[t._v("'BEGIN{ORS=\"\\n\\n\"};{print $1,$3}'")])]),t._v(" "),a("tr",[a("td",[t._v("FILENAME")]),t._v(" "),a("td",[t._v("当前输入的文件名")]),t._v(" "),a("td")])])]),t._v(" "),a("h2",{attrs:{id:"_1、-常用内置变量举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-常用内置变量举例"}},[t._v("#")]),t._v(" 1、==常用内置变量举例==")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{print $1,$(NF-1)}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{print $1,$(NF-1),$NF,NF}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk '/root/{print $0}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk '/root/' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '/root/{print $1,$NF}' 1.txt ")]),t._v("\nroot "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '/root/{print $0}' 1.txt      ")]),t._v("\nroot:x:0:0:root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR==1,NR==5' 1.txt ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR==1,NR==5{print $0}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR==1,NR==5;/^root/{print $0}' 1.txt ")]),t._v("\nroot:x:0:0:root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nroot:x:0:0:root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nbin:x:1:1:bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\ndaemon:x:2:2:daemon:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\nadm:x:3:4:adm:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("adm:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v(":x:4:7:"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("spool"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lpd:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n\n")])])]),a("h2",{attrs:{id:"_2、内置变量分隔符举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、内置变量分隔符举例"}},[t._v("#")]),t._v(" 2、内置变量分隔符举例")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("FS和OFS:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{FS=\":\"};/^root/,/^lp/{print $1,$NF}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: 'BEGIN{OFS=\"\\t\\t\"};/^root/,/^lp/{print $1,$NF}' 1.txt        ")]),t._v("\nroot            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nbin             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\ndaemon          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\nadm             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("              "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: 'BEGIN{OFS=\"@@@\"};/^root/,/^lp/{print $1,$NF}' 1.txt     ")]),t._v("\nroot@@@"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nbin@@@"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\ndaemon@@@"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\nadm@@@"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("@@@"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@server shell07]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n\nRS和ORS：\n修改源文件前2行增加制表符和内容：\nvim 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt\nroot:x:0:0:root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash hello   world\nbin:x:1:1:bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin        test1   test2\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{RS=\"\\t\"};{print $0}' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{ORS=\"\\t\"};{print $0}' 1.txt")]),t._v("\n")])])]),a("h1",{attrs:{id:"四、-awk工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、-awk工作原理"}},[t._v("#")]),t._v(" 四、 awk工作原理")]),t._v(" "),a("p",[a("code",[t._v("awk -F: '{print $1,$3}' /etc/passwd")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("awk使用一行作为输入，并将这一行赋给内部变量$0，每一行也可称为一个记录，以换行符(RS)结束")])]),t._v(" "),a("li",[a("p",[t._v("每行被间隔符**==:==**(默认为空格或制表符)分解成字段(或域)，每个字段存储在已编号的变量中，从$1开始")]),t._v(" "),a("p",[t._v("问：awk如何知道用空格来分隔字段的呢？")]),t._v(" "),a("p",[t._v("答：因为有一个内部变量==FS==来确定字段分隔符。初始时，FS赋为空格")])]),t._v(" "),a("li",[a("p",[t._v("awk使用print函数打印字段，打印出来的字段会以==空格分隔==，因为$1,$3之间有一个逗号。逗号比较特殊，它映射为另一个内部变量，称为==输出字段分隔符==OFS，OFS默认为空格")])]),t._v(" "),a("li",[a("p",[t._v("awk处理完一行后，将从文件中获取另一行，并将其存储在$0中，覆盖原来的内容，然后将新的字符串分隔成字段并进行处理。该过程将持续到所有行处理完毕")])])]),t._v(" "),a("h1",{attrs:{id:"五、awk使用进阶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、awk使用进阶"}},[t._v("#")]),t._v(" 五、awk使用进阶")]),t._v(" "),a("h2",{attrs:{id:"_1-格式化输出print和printf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-格式化输出print和printf"}},[t._v("#")]),t._v(" 1. 格式化输出"),a("code",[t._v("print")]),t._v("和"),a("code",[t._v("printf")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("print函数\t\t类似"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# date |awk \'{print "Month: "$2 "\\nYear: "$NF}\'')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# awk -F: \'{print "username is: " $1 "\\t uid is: "$3}\' /etc/passwd')]),t._v("\n\n\nprintf函数\t\t类似"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{printf \"%-15s %-10s %-15s\\n\", $1,$2,$3}'  /etc/passwd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{printf \"|%15s| %10s| %15s|\\n\", $1,$2,$3}' /etc/passwd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{printf \"|%-15s| %-10s| %-15s|\\n\", $1,$2,$3}' /etc/passwd")]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'BEGIN{FS=":"};{printf "%-15s %-15s %-15s\\n",$1,$6,$NF}\'')]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("s 字符类型  strings\t\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("20s\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("d 数值类型\t\n占15字符\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 表示左对齐，默认是右对齐\nprintf默认不会在行尾自动换行，加\\n\n")])])]),a("h2",{attrs:{id:"_2-awk变量定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-awk变量定义"}},[t._v("#")]),t._v(" 2. awk变量定义")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -v NUM=3 -F: '{ print $NUM }' /etc/passwd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -v NUM=3 -F: '{ print NUM }' /etc/passwd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -v num=1 'BEGIN{print num}' ")]),t._v("\n1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -v num=1 'BEGIN{print $num}' ")]),t._v("\n注意：\nawk中调用定义的变量不需要加$\n")])])]),a("p",[t._v("##3. awk中BEGIN...END使用")]),t._v(" "),a("p",[t._v("​\t①==BEGIN==：表示在==程序开始前==执行")]),t._v(" "),a("p",[t._v("​\t②==END== ：表示所有文件==处理完后==执行")]),t._v(" "),a("p",[t._v("​\t③用法："),a("code",[t._v("'BEGIN{开始处理之前};{处理中};END{处理结束后}'")])]),t._v(" "),a("h4",{attrs:{id:"㈠-举例说明1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈠-举例说明1"}},[t._v("#")]),t._v(" ㈠ 举例说明1")]),t._v(" "),a("p",[a("strong",[t._v("打印最后一列和倒数第二列（登录shell和家目录）")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("awk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'BEGIN{ print "Login_shell\\t\\tLogin_home\\n*******************"};{print $NF"\\t\\t"$(NF-1)};END{print "************************"}\'')]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt\n\nawk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'BEGIN{ FS=":";print "Login_shell\\tLogin_home\\n*******************"};{print $NF"\\t"$(NF-1)};END{print "************************"}\'')]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt\n\nLogin_shell\t\tLogin_home\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("adm\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("spool"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lpd\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("redhat\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("user01\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("named\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("u01\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("YUNWEI\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n")])])]),a("h4",{attrs:{id:"㈡-举例说明2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈡-举例说明2"}},[t._v("#")]),t._v(" ㈡ 举例说明2")]),t._v(" "),a("p",[a("strong",[t._v("打印/etc/passwd里的用户名、家目录及登录shell")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("u_name      h_dir       shell\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'BEGIN{OFS="\\t\\t";print"u_name\\t\\th_dir\\t\\tshell\\n***************************"};{printf "%-20s %-20s %-20s\\n",$1,$(NF-1),$NF};END{print "****************************"}\'')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# awk -F: \'BEGIN{print "u_name\\t\\th_dir\\t\\tshell" RS "*****************"}  {printf "%-15s %-20s %-20s\\n",$1,$(NF-1),$NF}END{print "***************************"}\'  /etc/passwd')]),t._v("\n\n格式化输出：\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v("\t\tprint\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n\tprintf\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("printf "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%-15s %-20s %-20s\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NF"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_4-awk和正则的综合运用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-awk和正则的综合运用"}},[t._v("#")]),t._v(" 4. awk和正则的综合运用")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("运算符")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("==")]),t._v(" "),a("td",[t._v("等于")])]),t._v(" "),a("tr",[a("td",[t._v("!=")]),t._v(" "),a("td",[t._v("不等于")])]),t._v(" "),a("tr",[a("td",[t._v(">")]),t._v(" "),a("td",[t._v("大于")])]),t._v(" "),a("tr",[a("td",[t._v("<")]),t._v(" "),a("td",[t._v("小于")])]),t._v(" "),a("tr",[a("td",[t._v(">=")]),t._v(" "),a("td",[t._v("大于等于")])]),t._v(" "),a("tr",[a("td",[t._v("<=")]),t._v(" "),a("td",[t._v("小于等于")])]),t._v(" "),a("tr",[a("td",[t._v("~")]),t._v(" "),a("td",[t._v("匹配")])]),t._v(" "),a("tr",[a("td",[t._v("!~")]),t._v(" "),a("td",[t._v("不匹配")])]),t._v(" "),a("tr",[a("td",[t._v("!")]),t._v(" "),a("td",[t._v("逻辑非")])]),t._v(" "),a("tr",[a("td",[t._v("&&")]),t._v(" "),a("td",[t._v("逻辑与")])]),t._v(" "),a("tr",[a("td",[t._v("||")]),t._v(" "),a("td",[t._v("逻辑或")])])])]),t._v(" "),a("h3",{attrs:{id:"㈠-举例说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈠-举例说明"}},[t._v("#")]),t._v(" ㈠ 举例说明")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("从第一行开始匹配到以"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("开头行\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR==1,/^lp/{print $0 }'")]),t._v(" passwd  \n从第一行到第5行          \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR==1,NR==5{print $0 }'")]),t._v(" passwd\n从以"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("开头的行匹配到第10行       \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^lp/,NR==10{print $0 }'")]),t._v(" passwd \n从以root开头的行匹配到以"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("开头的行       \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^root/,/^lp/{print $0}'")]),t._v(" passwd\n打印以root开头或者以"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v("开头的行            \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^root/ || /^lp/{print $0}'")]),t._v(" passwd\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^root/;/^lp/{print $0}'")]),t._v(" passwd\n显示5"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("10行   \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR>=5 && NR<=10 {print $0}'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd     \nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NR<10 && NR>5 {print $0}'")]),t._v(" passwd \n\n打印30"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("39行以bash结尾的内容：\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=30 && NR<=39 && $0 ~ /bash$/{print $0}' passwd ")]),t._v("\nstu1:x:500:500::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("stu1:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nyunwei:x:501:501::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("yunwei:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nuser01:x:502:502::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("user01:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nuser02:x:503:503::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("user02:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nuser03:x:504:504::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("user03:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=3 && NR<=8 && /bash$/' 1.txt  ")]),t._v("\nstu7:x:1007:1007::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rhome"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("stu7:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nstu8:x:1008:1008::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rhome"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("stu8:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\nstu9:x:1009:1009::"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rhome"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("stu9:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n\n打印文件中1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("5并且以root开头的行\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=1 && NR<=5 && $0 ~ /^root/{print $0}' 1.txt")]),t._v("\nroot:x:0:0:root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=1 && NR<=5 && $0 !~ /^root/{print $0}' 1.txt")]),t._v("\nbin:x:1:1:bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\ndaemon:x:2:2:daemon:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\nadm:x:3:4:adm:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("adm:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v(":x:4:7:"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("spool"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lpd:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin\n\n\n理解"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("号和"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("的含义：\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=3 && NR<=8 || /bash$/' 1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou shell06]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'NR>=3 && NR<=8;/bash$/' 1.txt")]),t._v("\n\n\n打印IP地址\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig eth0|awk 'NR>1 {print $2}'|awk -F':' 'NR<2 {print $2}'    ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig eth0|grep Bcast|awk -F':' '{print $2}'|awk '{print $1}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig eth0|grep Bcast|awk '{print $2}'|awk -F: '{print $2}'")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig eth0|awk NR==2|awk -F '[ :]+' '{print $4RS$6RS$8}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig eth0|awk -F\"[ :]+\" '/inet addr:/{print $4}'")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4-课堂练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-课堂练习"}},[t._v("#")]),t._v(" 4. 课堂练习")]),t._v(" "),a("ol",[a("li",[t._v("显示可以登录操作系统的用户所有信息     从第7列匹配以bash结尾，输出整行（当前行所有的列）")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bash$/{print $0}'")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bash$/{print $0}'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bash$/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$7 ~ /bash/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$NF ~ /bash/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$0 ~ /bash/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@MissHou ~]")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$0 ~ /\\/bin\\/bash/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("显示可以登录系统的用户名")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '$0 ~ /\\/bin\\/bash/{print $1}' /etc/passwd")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("打印出系统中普通用户的UID和用户名")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("500\tstu1\n501\tyunwei\n502\tuser01\n503\tuser02\n504\tuser03\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# awk -F: \'BEGIN{print "UID\\tUSERNAME"} {if($3>=500 && $3 !=65534 ) {print $3"\\t"$1} }\' /etc/passwdUID\tUSERNAME')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{if($3 >= 500 && $3 != 65534) print $1,$3}' a.txt ")]),t._v("\nredhat 508\nuser01 509\nu01 510\nYUNWEI 511\n")])])]),a("p",[t._v("##5. awk的脚本编程")]),t._v(" "),a("h3",{attrs:{id:"㈠-流程控制语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈠-流程控制语句"}},[t._v("#")]),t._v(" ㈠ 流程控制语句")]),t._v(" "),a("h4",{attrs:{id:"①-if结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#①-if结构"}},[t._v("#")]),t._v(" ① if结构")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("语句：\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("then\nxxx\nfi\n\n格式：\nawk 选项 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'正则，地址定位{awk语句}'")]),t._v("  文件名\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("表达式"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("｛语句1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{if($3>=500 && $3<=60000) {print $1,$3} }'")]),t._v(" passwd\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{if($3==0) {print $1\"是管理员\"} }' passwd ")]),t._v("\nroot是管理员\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{if('$(id -u)'==0) {print \"admin\"} }'")]),t._v("\nadmin\n")])])]),a("h4",{attrs:{id:"②-if-else结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#②-if-else结构"}},[t._v("#")]),t._v(" ② if...else结构")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("语句:\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" xxx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("then\n\txxxxx\n\t\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n\txxx\nfi\n\n格式：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("表达式"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ if($3>=500 && $3 != 65534) {print $1"是普通用户"} else {print $1,"不是普通用户"}}\'')]),t._v(" passwd \n\nawk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BEGIN{if( '")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'>=500 && '")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\' !=65534 ) {print "是普通用户"} else {print "不是普通用户"}}\'')]),t._v("\n\n")])])]),a("h4",{attrs:{id:"③-if-elif-else结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#③-if-elif-else结构"}},[t._v("#")]),t._v(" ③ if...elif...else结构")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[xxxx]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("then\n\txxxx\nelif "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[xxx]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("then\n\txxx\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nfi\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("语句：\n\n格式：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("表达式1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句；"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("表达式2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句；"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("表达式3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句；"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("｛语句"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("语句；"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("｝"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ if($3==0) {print $1,":是管理员"} else if($3>=1 && $3<=499 || $3==65534 ) {print $1,":是系统用户"} else {print $1,":是普通用户"}}\'')]),t._v("\n\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ if($3==0) {i++} else if($3>=1 && $3<=499 || $3==65534 ) {j++} else {k++}};END{print "管理员个数为:"i "\\n系统用户个数为:"j"\\n普通用户的个数为:"k }\'')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# awk -F: \'{if($3==0) {print $1,"is admin"} else if($3>=1 && $3<=499 || $3==65534) {print $1,"is sys users"} else {print $1,"is general user"} }\' a.txt ')]),t._v("\n\nroot is admin\nbin is sys users\ndaemon is sys users\nadm is sys users\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lp")]),t._v(" is sys users\nredhat is general user\nuser01 is general user\nnamed is sys users\nu01 is general user\nYUNWEI is general user\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{  if($3==0) {print $1":管理员"} else if($3>=1 && $3<500 || $3==65534 ) {print $1":是系统用户"} else {print $1":是普通用户"}}\'')]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{if($3==0) {i++} else if($3>=1 && $3<500 || $3==65534){j++} else {k++}};END{print "管理员个数为:" i RS "系统用户个数为:"j RS "普通用户的个数为:"k }\'')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n管理员个数为:1\n系统用户个数为:28\n普通用户的个数为:27\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# awk -F: \'{ if($3==0) {print $1":是管理员"} else if($3>=500 && $3!=65534) {print $1":是普通用户"} else {print $1":是系统用户"}}\' passwd ')]),t._v("\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{if($3==0){i++} else if($3>=500){k++} else{j++}} END{print i; print k; print j}'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd\n\nawk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("F: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{if($3==0){i++} else if($3>999){k++} else{j++}} END{print "管理员个数: "i; print "普通用个数: "k; print "系统用户: "j}\'')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("passwd \n\n如果是普通用户打印默认shell，如果是系统用户打印用户名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{if($3>=1 && $3<500 || $3 == 65534) {print $1} else if($3>=500 && $3<=60000 ) {print $NF} }' /etc/passwd")]),t._v("\n")])])]),a("h3",{attrs:{id:"㈡-循环语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#㈡-循环语句"}},[t._v("#")]),t._v(" ㈡ 循环语句")]),t._v(" "),a("h4",{attrs:{id:"①-for循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#①-for循环"}},[t._v("#")]),t._v(" ① for循环")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("打印1~5\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i<=5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$i")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("done\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN { for(i=1;i<=5;i++) {print i} }'")]),t._v("\n打印1~10中的奇数\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for ((i=1;i<=10;i+=2));do echo $i;done|awk '{sum+=$0};END{print sum}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{ for(i=1;i<=10;i+=2) {print i} }'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{ for(i=1;i<=10;i+=2) print i }'")]),t._v("\n\n计算1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("5的和\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{sum=0;for(i=1;i<=5;i++) sum+=i;print sum}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{for(i=1;i<=5;i++) (sum+=i);{print sum}}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{for(i=1;i<=5;i++) (sum+=i);print sum}'")]),t._v("\n")])])]),a("h4",{attrs:{id:"②-while循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#②-while循环"}},[t._v("#")]),t._v(" ② while循环")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("打印1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("5\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# i=1;while (($i<=5));do echo $i;let i++;done")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN { i=1;while(i<=5) {print i;i++} }'")]),t._v("\n打印1~10中的奇数\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{i=1;while(i<=10) {print i;i+=2} }'")]),t._v("\n计算1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("5的和\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{i=1;sum=0;while(i<=5) {sum+=i;i++}; print sum }'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN {i=1;while(i<=5) {(sum+=i) i++};print sum }'")]),t._v("\n")])])]),a("h4",{attrs:{id:"③-嵌套循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#③-嵌套循环"}},[t._v("#")]),t._v(" ③ 嵌套循环")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("嵌套循环：\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("y<=5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("y+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("x<="),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("x+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$x")]),t._v("\t\n\tdone\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v("\ndone\n\nawk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BEGIN{ for(y=1;y<=5;y++) {for(x=1;x<=y;x++) {printf x} ;print } }'")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN { for(y=1;y<=5;y++) { for(x=1;x<=y;x++) {printf x};print} }'")]),t._v("\n1\n12\n123\n1234\n12345\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{ y=1;while(y<=5) { for(x=1;x<=y;x++) {printf x};y++;print}}'")]),t._v("\n1\n12\n123\n1234\n12345\n\n尝试用三种方法打印99口诀表：\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#awk \'BEGIN{for(y=1;y<=9;y++) { for(x=1;x<=y;x++) {printf x"*"y"="x*y"\\t"};print} }\'')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#awk \'BEGIN{for(y=1;y<=9;y++) { for(x=1;x<=y;x++) printf x"*"y"="x*y"\\t";print} }\'')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#awk \'BEGIN{i=1;while(i<=9){for(j=1;j<=i;j++) {printf j"*"i"="j*i"\\t"};print;i++ }}\'')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#awk \'BEGIN{for(i=1;i<=9;i++){j=1;while(j<=i) {printf j"*"i"="i*j"\\t";j++};print}}\'')]),t._v("\n\n循环的控制：\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\t\t条件满足的时候中断循环\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\t条件满足的时候跳过循环\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{for(i=1;i<=5;i++) {if(i==3) break;print i} }'")]),t._v("\n1\n2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{for(i=1;i<=5;i++){if(i==3) continue;print i}}'")]),t._v("\n1\n2\n4\n5\n")])])]),a("h2",{attrs:{id:"_6-awk算数运算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-awk算数运算"}},[t._v("#")]),t._v(" 6. awk算数运算")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("模"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ^"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("幂2^3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n可以在模式中执行计算，awk都将按浮点数方式执行算术运算\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{print 1+1}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{print 1**1}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{print 2**3}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk 'BEGIN{print 2/3}'")]),t._v("\n")])])]),a("h1",{attrs:{id:"六、awk统计案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、awk统计案例"}},[t._v("#")]),t._v(" 六、awk统计案例")]),t._v(" "),a("h2",{attrs:{id:"_1、统计系统中各种类型的shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、统计系统中各种类型的shell"}},[t._v("#")]),t._v(" 1、统计系统中各种类型的shell")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# awk -F: '{ shells[$NF]++ };END{for (i in shells) {print i,shells[i]} }' /etc/passwd")]),t._v("\n\nbooks"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[linux]")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\nbooks"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[linux]")]),t._v("=1\nshells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\nshells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash 5\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin 6\n\nshells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\t\t\ta\nshells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nologin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\t\tb\nshells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("shutdown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\tc\n\nbooks"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[linux]")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\nbooks"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[php]")]),t._v("+"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"_2、统计网站访问状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、统计网站访问状态"}},[t._v("#")]),t._v(" 2、统计网站访问状态")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ss -antp|grep 80|awk '{states[$1]++};END{for(i in states){print i,states[i]}}'")]),t._v("\nTIME_WAIT 578\nESTABLISHED 1\nLISTEN 1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ss -an |grep :80 |awk '{states[$2]++};END{for(i in states){print i,states[i]}}'")]),t._v("\nLISTEN 1\nESTAB 5\nTIME"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("WAIT 25\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ss -an |grep :80 |awk '{states[$2]++};END{for(i in states){print i,states[i]}}' |sort -k2 -rn")]),t._v("\nTIME"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("WAIT 18\nESTAB 8\nLISTEN 1\n\n")])])]),a("h2",{attrs:{id:"_3、统计访问网站的每个ip的数量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、统计访问网站的每个ip的数量"}},[t._v("#")]),t._v(" 3、统计访问网站的每个IP的数量")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# netstat -ant |grep :80 |awk -F: '{ip_count[$8]++};END{for(i in ip_count){print i,ip_count[i]} }' |sort")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ss -an |grep :80 |awk -F\":\" '!/LISTEN/{ip_count[$(NF-1)]++};END{for(i in ip_count){print i,ip_count[i]}}' |sort -k2 -rn |head")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4、统计网站日志中pv量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、统计网站日志中pv量"}},[t._v("#")]),t._v(" 4、统计网站日志中PV量")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("统计Apache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Nginx日志中某一天的PV量 　<统计日志>\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# grep '27/Jul/2017' mysqladmin.cc-access_log |wc -l")]),t._v("\n14519\n\n统计Apache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Nginx日志中某一天不同IP的访问量　<统计日志>\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# grep '27/Jul/2017' mysqladmin.cc-access_log |awk '{ips[$1]++};END{for(i in ips){print i,ips[i]} }' |sort -k2 -rn |head")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# grep '07/Aug/2017' access.log |awk '{ips[$1]++};END{for(i in ips){print i,ips[i]} }' |awk '$2>100' |sort -k2 -rn")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("名词解释：")])]),t._v(" "),a("p",[t._v("==网站浏览量（PV）==\n名词：PV=PageView (网站浏览量)\n说明：指页面的浏览次数，用以衡量网站用户访问的网页数量。多次打开同一页面则浏览量累计。用户每打开一个页面便记录1次PV。")]),t._v(" "),a("p",[t._v("名词：VV = Visit View（访问次数）\n说明：从访客来到您网站到最终关闭网站的所有页面离开，计为1次访问。若访客连续30分钟没有新开和刷新页面，或者访客关闭了浏览器，则被计算为本次访问结束。")]),t._v(" "),a("p",[t._v("独立访客（UV）\n名词：UV= Unique Visitor（独立访客数）\n说明：1天内相同的访客多次访问您的网站只计算1个UV。")]),t._v(" "),a("p",[t._v("独立IP（IP）\n名词：IP=独立IP数\n说明：指1天内使用不同IP地址的用户访问网站的数量。同一IP无论访问了几个页面，独立IP数均为1")]),t._v(" "),a("p",[t._v("#七、课后作业")]),t._v(" "),a("p",[a("strong",[t._v("作业1：")]),t._v("\n1、写一个自动检测磁盘使用率的脚本，当磁盘使用空间达到90%以上时，需要发送邮件给相关人员\n2、写一个脚本监控系统内存和交换分区使用情况")]),t._v(" "),a("p",[a("strong",[t._v("作业2：")]),t._v("\n输入一个IP地址，使用脚本判断其合法性：\n必须符合ip地址规范，第1、4位不能以0开头，不能大于255不能小于0")]),t._v(" "),a("p",[t._v("#八、企业实战案例")]),t._v(" "),a("h4",{attrs:{id:"_1-任务-背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-任务-背景"}},[t._v("#")]),t._v(" 1. 任务/背景")]),t._v(" "),a("p",[t._v("web服务器集群中总共有9台机器，上面部署的是Apache服务。由于业务不断增长，每天每台机器上都会产生大量的访问日志，现需要将每台web服务器上的apache访问日志"),a("strong",[t._v("保留最近3天")]),t._v("的，3天以前的日志"),a("strong",[t._v("转储")]),t._v("到一台专门的日志服务器上，已做后续分析。如何实现每台服务器上只保留3天以内的日志？")]),t._v(" "),a("h4",{attrs:{id:"_2-具体要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体要求"}},[t._v("#")]),t._v(" 2. 具体要求")]),t._v(" "),a("ol",[a("li",[t._v("每台web服务器的日志对应日志服务器相应的目录里。如：web1——>web1.log（在日志服务器上）")]),t._v(" "),a("li",[t._v("每台web服务器上保留最近3天的访问日志，3天以前的日志每天凌晨5:03分转储到日志服务器")]),t._v(" "),a("li",[t._v("如果脚本转储失败，运维人员需要通过跳板机的菜单选择手动清理日志")])]),t._v(" "),a("h4",{attrs:{id:"_3-涉及知识点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-涉及知识点"}},[t._v("#")]),t._v(" 3. 涉及知识点")]),t._v(" "),a("ol",[a("li",[t._v("shell的基本语法结构")]),t._v(" "),a("li",[t._v("文件同步rsync")]),t._v(" "),a("li",[t._v("文件查找命令find")]),t._v(" "),a("li",[t._v("计划任务crontab")]),t._v(" "),a("li",[t._v("apache日志切割")]),t._v(" "),a("li",[t._v("其他")])])])}),[],!1,null,null,null);s.default=n.exports}}]);